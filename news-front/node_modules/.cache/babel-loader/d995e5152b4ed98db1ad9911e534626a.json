{"ast":null,"code":"var _jsxFileName = \"C:\\\\git\\\\laboratory\\\\news-front\\\\src\\\\component\\\\NewsEditForm.jsx\";\nimport React from 'react';\nimport NewsDataService from './NewsDataService';\nimport TagDataService from './TagDataService';\nimport AuthorDataService from './AuthorDataService';\nimport TagButton from './TagButton';\n\nclass NewsEditForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      newsId: {},\n      newsTitle: '',\n      newsShortText: '',\n      newsFullText: '',\n      creationDate: '',\n      author: {},\n      tags: [],\n      allTags: [],\n      allAuthors: []\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.match.params.id > 0) {\n      this.refreshNews(this.props.match.params.id);\n    }\n\n    this.refreshAuthorsList();\n    this.refreshTagsList();\n  }\n\n  refreshNews(id) {\n    NewsDataService.getNewsById(id).then(response => {\n      this.setState({\n        newsId: response.data.id\n      });\n      this.setState({\n        newsTitle: response.data.title\n      });\n      this.setState({\n        newsShortText: response.data.shortText\n      });\n      this.setState({\n        newsFullText: response.data.fullText\n      });\n      this.setState({\n        creationDate: response.data.creationDate\n      });\n      this.setState({\n        author: response.data.author\n      });\n      this.setState({\n        tags: response.data.tags\n      });\n    });\n  }\n\n  refreshTagsList() {\n    TagDataService.getAllTags().then(response => {\n      this.setState({\n        allTags: response.data\n      });\n    });\n  }\n\n  refreshAuthorsList() {\n    AuthorDataService.getAllAuthors().then(response => {\n      this.setState({\n        allAuthors: response.data\n      });\n    });\n  }\n\n  editNews() {\n    let news = this.buildNewsObjectFromFormFieldsAndState();\n\n    if (this.state.newsId > 0) {\n      NewsDataService.editNews(news).then(response => {\n        window.location.href = \"/news/edit/\" + response.data.id;\n      });\n    } else {\n      NewsDataService.createNews(news).then(response => {\n        window.location.href = \"/news/edit/\" + response.data.id;\n      });\n    }\n  }\n\n  deleteTagFromState(tagName) {\n    let stateTagsArray = [];\n    stateTagsArray = this.state.tags;\n\n    for (var k = 0; k < stateTagsArray.length; k++) {\n      if (stateTagsArray[k].name === tagName) {\n        stateTagsArray.splice(k, 1);\n        break;\n      }\n    }\n\n    this.setState({\n      tags: stateTagsArray\n    });\n  }\n\n  setNewTagsToState() {\n    let stateTagsArray = [];\n    stateTagsArray = this.state.tags;\n    let newTagFieldValue = document.getElementById(\"newTagField\").value;\n    let selectTagFieldValue = document.getElementById(\"tag-select-field\").childNodes;\n\n    for (var i = 0; i < selectTagFieldValue.length; i++) {\n      if (selectTagFieldValue[i].selected) {\n        var containsInState = false;\n\n        for (var j = 0; j < stateTagsArray.length; j++) {\n          if (stateTagsArray[j].name === selectTagFieldValue[i].textContent) {\n            containsInState = true;\n            break;\n          }\n        }\n\n        if (!containsInState) {\n          stateTagsArray.push({\n            id: selectTagFieldValue[i].value,\n            name: selectTagFieldValue[i].textContent\n          });\n        }\n\n        containsInState = false;\n      }\n    }\n\n    var thisTagContainsInState = false;\n\n    for (var k = 0; k < stateTagsArray.length; k++) {\n      if (stateTagsArray[k].name === newTagFieldValue) {\n        thisTagContainsInState = true;\n        break;\n      }\n    }\n\n    if (newTagFieldValue.length !== 0 && !thisTagContainsInState) {\n      stateTagsArray.push({\n        id: null,\n        name: newTagFieldValue\n      });\n    }\n\n    for (var i = 0; i < selectTagFieldValue.length; i++) {\n      if (selectTagFieldValue[i].selected) {\n        selectTagFieldValue[i].selected = false;\n      }\n    }\n\n    this.setState({\n      tags: stateTagsArray\n    });\n  }\n\n  buildNewsObjectFromFormFieldsAndState() {\n    let formTitle = document.getElementById(\"newsTitleField\").value;\n    let formShortText = document.getElementById(\"newsShortTextField\").value;\n    let formFullText = document.getElementById(\"newsFullTextField\").value;\n    let selectedAuthor = {};\n    let selectAuthorFieldValue = document.getElementById(\"authorsSelectField\").childNodes;\n\n    for (var i = 0; i < selectAuthorFieldValue.length; i++) {\n      if (selectAuthorFieldValue[i].selected) {\n        selectedAuthor = {\n          id: selectAuthorFieldValue[i].value,\n          name: null,\n          surname: null\n        };\n      }\n    }\n\n    var newsObject = {};\n\n    if (this.props.match.params.id < 0) {\n      newsObject = {\n        title: formTitle,\n        shortText: formShortText,\n        fullText: formFullText,\n        author: selectedAuthor,\n        tags: this.state.tags\n      };\n    } else {\n      newsObject = {\n        id: this.state.newsId,\n        title: formTitle,\n        shortText: formShortText,\n        fullText: formFullText,\n        creationDate: this.state.creationDate,\n        author: selectedAuthor,\n        tags: this.state.tags\n      };\n    }\n\n    return newsObject;\n  }\n\n  cleanErrorMessage(errorFieldId) {\n    let previousErrorMessage = document.getElementById(errorFieldId);\n\n    if (previousErrorMessage) {\n      previousErrorMessage.remove();\n    }\n  }\n\n  createErrorField(fieldId, errorMessage, afterElementId) {\n    let small = document.createElement('small');\n    small.id = fieldId;\n    small.className = \"text-danger\";\n    small.innerText = errorMessage;\n    let fieldSet = document.getElementById(afterElementId);\n    fieldSet.after(small);\n  }\n\n  validateNewsTitle(value) {\n    let errorMessage = \"\";\n\n    if (!value) {\n      errorMessage = this.props.t(\"title_mustnt_be_empty\");\n    } else if (value.length > 30) {\n      errorMessage = this.props.t(\"title_mustnt_be_larger_than_30_characters\");\n    }\n\n    return errorMessage;\n  }\n\n  validateNewsShortText(value) {\n    let errorMessage = \"\";\n\n    if (!value) {\n      errorMessage = this.props.t(\"short_text_mustnt_be_empty\");\n    } else if (value.length > 200) {\n      errorMessage = this.props.t(\"short_text_mustnt_be_larger_than_200_characters\");\n    }\n\n    return errorMessage;\n  }\n\n  validateNewsFullText(value) {\n    let errorMessage = \"\";\n\n    if (!value) {\n      errorMessage = this.props.t(\"full_text_mustnt_be_empty\");\n    } else if (value.length > 2000) {\n      errorMessage = this.props.t(\"full_text_mustnt_be_larger_than_2000_characters\");\n    }\n\n    return errorMessage;\n  }\n\n  validateNewsTagValue(value) {\n    let errorMessage = \"\";\n\n    if (!value) {\n      errorMessage = this.props.t(\"tag_name_mustnt_be_empty\");\n    } else if (value.length > 30) {\n      errorMessage = this.props.t(\"tag_name_mustnt_be_larger_than_30_characters\");\n    } else {\n      const allTags = this.state.tags;\n\n      for (let tag of allTags) {\n        if (tag.name === value) {\n          errorMessage = this.props.t(\"tag_already_exists\");\n          break;\n        }\n      }\n    }\n\n    return errorMessage;\n  }\n\n  newsErrorsRender() {\n    let errorsExist = 0;\n    this.cleanErrorMessage(\"newsTitleErrorMessage\");\n    this.cleanErrorMessage(\"newsShortTextErrorMessage\");\n    this.cleanErrorMessage(\"newsFullTextErrorMessage\");\n    let newsTitle = document.getElementById(\"newsTitleField\").value;\n    let newsShortText = document.getElementById(\"newsShortTextField\").value;\n    let newsFullText = document.getElementById(\"newsFullTextField\").value;\n    let errorMessage1 = this.validateAuthorName(newsTitle);\n    let errorMessage2 = this.validateAuthorName(newsShortText);\n    let errorMessage3 = this.validateAuthorName(newsFullText);\n\n    if (errorMessage1) {\n      this.createErrorField(\"titleErrorMessage\", errorMessage1, \"titleInputGroup\");\n      errorsExist++;\n    }\n\n    if (errorMessage2) {\n      this.createErrorField(\"shortTextErrorMessage\", errorMessage2, \"shortTextInputGroup\");\n      errorsExist++;\n    }\n\n    if (errorMessage3) {\n      this.createErrorField(\"fullTextErrorMessage\", errorMessage3, \"fullTextInputGroup\");\n      errorsExist++;\n    }\n  }\n\n  tagErrorRender() {\n    let errorsExist = 0;\n    this.cleanErrorMessage(\"tagNameErrorMessage\");\n    let newTag = document.getElementById(\"newTagField\").value;\n    let errorMessage = this.validateAuthorName(newTag);\n\n    if (errorMessage) {\n      this.createErrorField(\"newTagErrorMessage\", errorMessage, \"newTagField\");\n      errorsExist++;\n    }\n\n    return errorsExist;\n  }\n\n  render() {\n    const renderAllAuthorsList = this.state.allAuthors.map(a => {\n      if (a.id == this.state.author.id) {\n        return React.createElement(\"option\", {\n          selected: true,\n          value: a.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 301\n          },\n          __self: this\n        }, a.name, \" \", a.surname);\n      } else {\n        return React.createElement(\"option\", {\n          value: a.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 305\n          },\n          __self: this\n        }, a.name, \" \", a.surname);\n      }\n    });\n    const renderAllTagsList = this.state.allTags.map(t => {\n      return React.createElement(\"option\", {\n        value: t.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312\n        },\n        __self: this\n      }, t.name);\n    });\n    const renderThisNewsTags = this.state.tags.map(tag => {\n      return React.createElement(TagButton, {\n        tagName: tag.name,\n        deleteClick: () => this.deleteTagFromState(tag.name),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      });\n    });\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"col-10\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"titleInputGroup\",\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"newsTitleField\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334\n      },\n      __self: this\n    }, this.props.t(\"title\")), React.createElement(\"input\", {\n      id: \"newsTitleField\",\n      className: \"form-control\",\n      type: \"text\",\n      maxLength: \"30\",\n      defaultValue: this.state.newsTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"newsShortTextField\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338\n      },\n      __self: this\n    }, this.props.t(\"short_text\")), React.createElement(\"textarea\", {\n      id: \"newsShortTextField\",\n      className: \"form-control\",\n      maxLength: \"100\",\n      rows: \"2\",\n      defaultValue: this.state.newsShortText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"newsFullTextField\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }, this.props.t(\"full_text\")), React.createElement(\"textarea\", {\n      className: \"form-control\",\n      id: \"newsFullTextField\",\n      maxLength: \"2000\",\n      rows: \"8\",\n      defaultValue: this.state.newsFullText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 345\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"authorsSelectField\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346\n      },\n      __self: this\n    }, this.props.t(\"author\")), React.createElement(\"select\", {\n      id: \"authorsSelectField\",\n      class: \"form-control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 347\n      },\n      __self: this\n    }, renderAllAuthorsList)), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 355\n      },\n      __self: this\n    }, this.props.t(\"selected_tags\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 356\n      },\n      __self: this\n    }, renderThisNewsTags)), React.createElement(\"div\", {\n      className: \"col-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"tagsMultiselectField\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361\n      },\n      __self: this\n    }, this.props.t(\"existing_tags\")), React.createElement(\"select\", {\n      multiple: true,\n      id: \"tag-select-field\",\n      className: \"form-control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 362\n      },\n      __self: this\n    }, renderAllTagsList), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"input-group mb-3 w-100 my-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 366\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      id: \"newTagField\",\n      type: \"text\",\n      className: \"form-control\",\n      placeholder: this.props.t(\"new_tag_name\"),\n      \"aria-describedby\": \"button-addon2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 367\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"input-group-append\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-outline-success btn-sm\",\n      type: \"button\",\n      id: \"add-tags-button\",\n      onClick: () => this.setNewTagsToState(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369\n      },\n      __self: this\n    }, this.props.t(\"add\"))))))))), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 379\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-primary btn-block mx-1\",\n      onClick: () => this.editNews(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380\n      },\n      __self: this\n    }, this.props.t(\"save\"))), React.createElement(\"div\", {\n      className: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"/\",\n      className: \"btn btn-outline-danger btn-block mx-1\",\n      role: \"button\",\n      \"aria-pressed\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383\n      },\n      __self: this\n    }, this.props.t(\"to_news_list\")))))))), React.createElement(\"div\", {\n      className: \"col-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 390\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default NewsEditForm;","map":{"version":3,"sources":["C:/git/laboratory/news-front/src/component/NewsEditForm.jsx"],"names":["React","NewsDataService","TagDataService","AuthorDataService","TagButton","NewsEditForm","Component","constructor","props","state","newsId","newsTitle","newsShortText","newsFullText","creationDate","author","tags","allTags","allAuthors","componentDidMount","match","params","id","refreshNews","refreshAuthorsList","refreshTagsList","getNewsById","then","response","setState","data","title","shortText","fullText","getAllTags","getAllAuthors","editNews","news","buildNewsObjectFromFormFieldsAndState","window","location","href","createNews","deleteTagFromState","tagName","stateTagsArray","k","length","name","splice","setNewTagsToState","newTagFieldValue","document","getElementById","value","selectTagFieldValue","childNodes","i","selected","containsInState","j","textContent","push","thisTagContainsInState","formTitle","formShortText","formFullText","selectedAuthor","selectAuthorFieldValue","surname","newsObject","cleanErrorMessage","errorFieldId","previousErrorMessage","remove","createErrorField","fieldId","errorMessage","afterElementId","small","createElement","className","innerText","fieldSet","after","validateNewsTitle","t","validateNewsShortText","validateNewsFullText","validateNewsTagValue","tag","newsErrorsRender","errorsExist","errorMessage1","validateAuthorName","errorMessage2","errorMessage3","tagErrorRender","newTag","render","renderAllAuthorsList","map","a","renderAllTagsList","renderThisNewsTags"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport NewsDataService from './NewsDataService'\r\nimport TagDataService from './TagDataService'\r\nimport AuthorDataService from './AuthorDataService'\r\nimport TagButton from './TagButton'\r\n\r\n\r\nclass NewsEditForm extends React.Component {\r\n\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            newsId: {},\r\n            newsTitle: '',\r\n            newsShortText: '',\r\n            newsFullText: '',\r\n            creationDate: '',\r\n            author: {},\r\n            tags: [],\r\n            allTags: [],\r\n            allAuthors: [],\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        if(this.props.match.params.id > 0){\r\n            this.refreshNews(this.props.match.params.id);\r\n        }\r\n        this.refreshAuthorsList();\r\n        this.refreshTagsList(); \r\n    }\r\n\r\n    refreshNews(id) {\r\n        NewsDataService.getNewsById(id)\r\n        .then(\r\n            response => {\r\n                this.setState({newsId: response.data.id});\r\n                this.setState({newsTitle: response.data.title});\r\n                this.setState({newsShortText: response.data.shortText});\r\n                this.setState({newsFullText: response.data.fullText});\r\n                this.setState({creationDate: response.data.creationDate});\r\n                this.setState({author: response.data.author});\r\n                this.setState({tags: response.data.tags});\r\n            }\r\n        )\r\n    }\r\n\r\n    refreshTagsList(){\r\n        TagDataService.getAllTags()\r\n        .then(\r\n            response => {\r\n                this.setState({allTags: response.data});\r\n            }\r\n        )\r\n    }\r\n\r\n    refreshAuthorsList(){\r\n        AuthorDataService.getAllAuthors()\r\n        .then(\r\n            response => {\r\n                this.setState({allAuthors: response.data});\r\n            }\r\n        )\r\n    }\r\n\r\n    editNews(){\r\n        let news = this.buildNewsObjectFromFormFieldsAndState();\r\n        if(this.state.newsId > 0){\r\n            NewsDataService.editNews(news)\r\n            .then(\r\n                response => {\r\n                    window.location.href = \"/news/edit/\" + response.data.id;\r\n                }\r\n            )\r\n        } else {\r\n            NewsDataService.createNews(news)\r\n            .then(\r\n                response => {\r\n                    window.location.href = \"/news/edit/\" + response.data.id;\r\n                }\r\n            )\r\n        }\r\n        \r\n    }\r\n\r\n    deleteTagFromState(tagName){\r\n        let stateTagsArray = [];\r\n        stateTagsArray = this.state.tags;\r\n\r\n        for(var k=0; k<stateTagsArray.length; k++){\r\n            if(stateTagsArray[k].name === tagName){\r\n                stateTagsArray.splice(k, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        this.setState({tags: stateTagsArray});\r\n    }\r\n\r\n    setNewTagsToState(){\r\n        let stateTagsArray = [];\r\n        stateTagsArray = this.state.tags;\r\n        let newTagFieldValue = document.getElementById(\"newTagField\").value;\r\n        let selectTagFieldValue = document.getElementById(\"tag-select-field\").childNodes; \r\n\r\n        for(var i=0; i<selectTagFieldValue.length; i++){\r\n            if(selectTagFieldValue[i].selected){\r\n\r\n                var containsInState = false;\r\n\r\n                for(var j=0; j<stateTagsArray.length; j++){\r\n                    if(stateTagsArray[j].name === selectTagFieldValue[i].textContent){\r\n                        containsInState = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if(!containsInState){\r\n                    stateTagsArray.push({id: selectTagFieldValue[i].value, name: selectTagFieldValue[i].textContent});\r\n                }\r\n\r\n                containsInState = false;\r\n            }\r\n        }\r\n\r\n        var thisTagContainsInState = false;\r\n\r\n        for(var k=0; k<stateTagsArray.length; k++){\r\n            if(stateTagsArray[k].name === newTagFieldValue){\r\n                thisTagContainsInState = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if((newTagFieldValue.length !== 0) && (!thisTagContainsInState)){\r\n            stateTagsArray.push({id: null, name: newTagFieldValue});\r\n        }\r\n\r\n        for(var i=0; i<selectTagFieldValue.length; i++){\r\n            if(selectTagFieldValue[i].selected){\r\n                selectTagFieldValue[i].selected = false;\r\n            }\r\n        }\r\n\r\n        this.setState({tags: stateTagsArray});\r\n        \r\n    }\r\n\r\n    buildNewsObjectFromFormFieldsAndState(){\r\n        let formTitle = document.getElementById(\"newsTitleField\").value;\r\n        let formShortText = document.getElementById(\"newsShortTextField\").value;\r\n        let formFullText = document.getElementById(\"newsFullTextField\").value;\r\n\r\n        let selectedAuthor = {};\r\n        let selectAuthorFieldValue = document.getElementById(\"authorsSelectField\").childNodes; \r\n\r\n        for(var i=0; i<selectAuthorFieldValue.length; i++){\r\n            if(selectAuthorFieldValue[i].selected){\r\n                selectedAuthor = {id: selectAuthorFieldValue[i].value, name: null, surname: null};\r\n            }\r\n        }\r\n\r\n        var newsObject = {};\r\n        if(this.props.match.params.id < 0){\r\n            newsObject = {\r\n                title: formTitle,\r\n                shortText: formShortText,\r\n                fullText: formFullText,\r\n                author: selectedAuthor,\r\n                tags: this.state.tags};\r\n        } else {\r\n            newsObject = {\r\n                id: this.state.newsId,\r\n                title: formTitle,\r\n                shortText: formShortText,\r\n                fullText: formFullText,\r\n                creationDate: this.state.creationDate,\r\n                author: selectedAuthor,\r\n                tags: this.state.tags};\r\n        }\r\n\r\n        return newsObject;\r\n\r\n    }\r\n\r\n    cleanErrorMessage(errorFieldId){\r\n        let previousErrorMessage = document.getElementById(errorFieldId);\r\n        if (previousErrorMessage) {\r\n            previousErrorMessage.remove();\r\n        }\r\n    }\r\n\r\n    createErrorField(fieldId, errorMessage, afterElementId) {\r\n        let small = document.createElement('small');\r\n        small.id = fieldId;\r\n        small.className = \"text-danger\";\r\n        small.innerText = errorMessage;\r\n        let fieldSet = document.getElementById(afterElementId);\r\n        fieldSet.after(small);\r\n    }\r\n\r\n    validateNewsTitle(value) {\r\n        let errorMessage = \"\";\r\n        if (!value) {\r\n            errorMessage = this.props.t(\"title_mustnt_be_empty\");\r\n        } else if (value.length > 30) {\r\n            errorMessage = this.props.t(\"title_mustnt_be_larger_than_30_characters\");\r\n        } \r\n        return errorMessage;\r\n    }\r\n\r\n    validateNewsShortText(value) {\r\n        let errorMessage = \"\";\r\n        if (!value) {\r\n            errorMessage = this.props.t(\"short_text_mustnt_be_empty\");\r\n        } else if (value.length > 200) {\r\n            errorMessage = this.props.t(\"short_text_mustnt_be_larger_than_200_characters\");\r\n        } \r\n        return errorMessage;\r\n    }\r\n\r\n    validateNewsFullText(value) {\r\n        let errorMessage = \"\";\r\n        if (!value) {\r\n            errorMessage = this.props.t(\"full_text_mustnt_be_empty\");\r\n        } else if (value.length > 2000) {\r\n            errorMessage = this.props.t(\"full_text_mustnt_be_larger_than_2000_characters\");\r\n        } \r\n        return errorMessage;\r\n    }\r\n\r\n    validateNewsTagValue(value) {\r\n        let errorMessage = \"\";\r\n        if (!value) {\r\n            errorMessage = this.props.t(\"tag_name_mustnt_be_empty\");\r\n        } else if (value.length > 30) {\r\n            errorMessage = this.props.t(\"tag_name_mustnt_be_larger_than_30_characters\");\r\n        } else {\r\n            const allTags = this.state.tags;\r\n            for (let tag of allTags) {\r\n                if (tag.name === value) {\r\n                    errorMessage = this.props.t(\"tag_already_exists\");\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return errorMessage;\r\n    }\r\n\r\n    newsErrorsRender(){\r\n        let errorsExist = 0;\r\n\r\n        this.cleanErrorMessage(\"newsTitleErrorMessage\");\r\n        this.cleanErrorMessage(\"newsShortTextErrorMessage\");\r\n        this.cleanErrorMessage(\"newsFullTextErrorMessage\");\r\n\r\n        let newsTitle = document.getElementById(\"newsTitleField\").value;\r\n        let newsShortText = document.getElementById(\"newsShortTextField\").value;\r\n        let newsFullText = document.getElementById(\"newsFullTextField\").value;\r\n\r\n        let errorMessage1 = this.validateAuthorName(newsTitle);\r\n        let errorMessage2 = this.validateAuthorName(newsShortText);\r\n        let errorMessage3 = this.validateAuthorName(newsFullText);\r\n\r\n        if(errorMessage1){\r\n            this.createErrorField(\"titleErrorMessage\", errorMessage1, \"titleInputGroup\");\r\n            errorsExist++;\r\n        }\r\n\r\n        if(errorMessage2){\r\n            this.createErrorField(\"shortTextErrorMessage\", errorMessage2, \"shortTextInputGroup\");\r\n            errorsExist++;\r\n        }\r\n        \r\n        if(errorMessage3){\r\n            this.createErrorField(\"fullTextErrorMessage\", errorMessage3, \"fullTextInputGroup\");\r\n            errorsExist++;\r\n        }\r\n\r\n    }\r\n\r\n    tagErrorRender(){\r\n        let errorsExist = 0;\r\n\r\n        this.cleanErrorMessage(\"tagNameErrorMessage\");\r\n        let newTag = document.getElementById(\"newTagField\").value;\r\n        let errorMessage = this.validateAuthorName(newTag);\r\n\r\n        if(errorMessage){\r\n            this.createErrorField(\"newTagErrorMessage\", errorMessage, \"newTagField\");\r\n            errorsExist++;\r\n        }\r\n\r\n        return errorsExist;\r\n    }\r\n\r\n    render(){\r\n\r\n        const renderAllAuthorsList = this.state.allAuthors.map(a => {\r\n            if(a.id == this.state.author.id){\r\n                return(\r\n                    <option selected value={a.id}>{a.name} {a.surname}</option>\r\n                )\r\n            } else {\r\n                return(\r\n                    <option value={a.id}>{a.name} {a.surname}</option>\r\n                )\r\n            }\r\n        })\r\n\r\n        const renderAllTagsList = this.state.allTags.map(t => {\r\n            return(\r\n                <option value={t.id}>{t.name}</option>\r\n            )\r\n        })\r\n\r\n        const renderThisNewsTags = this.state.tags.map(tag => {\r\n            return(\r\n                <TagButton \r\n                tagName={tag.name}\r\n                deleteClick={() => this.deleteTagFromState(tag.name)}\r\n                />\r\n            )\r\n        }) \r\n\r\n        return(\r\n\r\n            <div className=\"container\">\r\n            <div className=\"row\">\r\n                <div className=\"col-1\"></div>\r\n                <div className=\"col-10\">\r\n                    <div>\r\n                        <form>\r\n                            <div id=\"titleInputGroup\" className=\"form-group\">\r\n                                <label for=\"newsTitleField\">{this.props.t(\"title\")}</label>\r\n                                <input id=\"newsTitleField\" className=\"form-control\" type=\"text\" maxLength=\"30\" defaultValue={this.state.newsTitle}/>\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label for=\"newsShortTextField\">{this.props.t(\"short_text\")}</label>\r\n                                <textarea id=\"newsShortTextField\" className=\"form-control\" maxLength=\"100\" rows=\"2\" defaultValue={this.state.newsShortText}></textarea>\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label for=\"newsFullTextField\">{this.props.t(\"full_text\")}</label>\r\n                                <textarea className=\"form-control\" id=\"newsFullTextField\"  maxLength=\"2000\" rows=\"8\" defaultValue={this.state.newsFullText}></textarea>\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label for=\"authorsSelectField\">{this.props.t(\"author\")}</label>\r\n                                    <select id=\"authorsSelectField\" class=\"form-control\">\r\n                                        {renderAllAuthorsList}\r\n                                    </select>\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <div className=\"container\">\r\n                                    <div className=\"row\">\r\n                                        <div className=\"col-6\">\r\n                                            <label>{this.props.t(\"selected_tags\")}</label>\r\n                                            <div>\r\n                                                {renderThisNewsTags}\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"col-6\">\r\n                                            <label for=\"tagsMultiselectField\">{this.props.t(\"existing_tags\")}</label>\r\n                                            <select multiple  id=\"tag-select-field\" className=\"form-control\">\r\n                                                {renderAllTagsList}\r\n                                            </select>\r\n                                            <div>\r\n                                                <div className=\"input-group mb-3 w-100 my-3\">\r\n                                                    <input id=\"newTagField\" type=\"text\" className=\"form-control\" placeholder={this.props.t(\"new_tag_name\")} aria-describedby=\"button-addon2\"/>\r\n                                                    <div className=\"input-group-append\">\r\n                                                        <button className=\"btn btn-outline-success btn-sm\" type=\"button\" id=\"add-tags-button\" onClick={() => this.setNewTagsToState()}>{this.props.t(\"add\")}</button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"container\">\r\n                                <div className=\"row\">\r\n                                    <div className=\"col\">\r\n                                        <button type=\"button\" className=\"btn btn-primary btn-block mx-1\" onClick={() => this.editNews()}>{this.props.t(\"save\")}</button>\r\n                                    </div>\r\n                                    <div className=\"col\">\r\n                                        <a href=\"/\" className=\"btn btn-outline-danger btn-block mx-1\" role=\"button\" aria-pressed=\"true\">{this.props.t(\"to_news_list\")}</a>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n                <div className=\"col-1\"></div>\r\n            </div>\r\n        </div>\r\n           \r\n        );\r\n    }\r\n}\r\n\r\nexport default NewsEditForm"]},"metadata":{},"sourceType":"module"}