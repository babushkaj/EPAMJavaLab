{"ast":null,"code":"var _jsxFileName = \"C:\\\\git\\\\laboratory\\\\news-front\\\\src\\\\component\\\\NewsEditForm.jsx\";\nimport React from 'react';\nimport NewsDataService from './NewsDataService';\nimport TagDataService from './TagDataService';\nimport TagButton from './TagButton';\n\nclass NewsEditForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.getNewsByIdCallback = this.getNewsByIdCallback.bind(this);\n    this.getAllTagsCallback = this.getAllTagsCallback.bind(this);\n    this.editNewsCallback = this.editNewsCallback.bind(this);\n    this.state = {\n      newsId: {},\n      newsTitle: '',\n      newsShortText: '',\n      newsFullText: '',\n      creationDate: '',\n      author: {},\n      tags: [],\n      allTags: []\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.match.params.id > 0) {\n      this.refreshNews(this.props.match.params.id);\n    }\n\n    this.refreshTagsList();\n  }\n\n  refreshNews(id) {\n    NewsDataService.getNewsById(this.getNewsByIdCallback, id);\n  }\n\n  refreshTagsList() {\n    TagDataService.getAllTags(this.getAllTagsCallback);\n  }\n\n  editNews() {\n    let news = this.buildNewsObjectFromFormFieldsAndState();\n    console.log(\"ID: \" + this.state.newsId);\n\n    if (this.state.newsId > 0) {\n      NewsDataService.editNews(this.editNewsCallback, news);\n    } else {\n      NewsDataService.createNews(this.editNewsCallback, news);\n    }\n  }\n\n  getAllTagsCallback(result) {\n    this.setState({\n      allTags: result\n    });\n  }\n\n  getNewsByIdCallback(result) {\n    this.setState({\n      newsId: result.id\n    });\n    this.setState({\n      newsTitle: result.title\n    });\n    this.setState({\n      newsShortText: result.shortText\n    });\n    this.setState({\n      newsFullText: result.fullText\n    });\n    this.setState({\n      creationDate: result.creationDate\n    });\n    this.setState({\n      author: result.author\n    });\n    this.setState({\n      tags: result.tags\n    });\n  }\n\n  editNewsCallback(result) {\n    window.location.href = \"/news/edit/\" + result.id;\n  }\n\n  deleteTagFromState(tagName) {\n    let stateTagsArray = [];\n    stateTagsArray = this.state.tags;\n\n    for (var k = 0; k < stateTagsArray.length; k++) {\n      if (stateTagsArray[k].name === tagName) {\n        stateTagsArray.splice(k, 1);\n        break;\n      }\n    }\n\n    this.setState({\n      tags: stateTagsArray\n    });\n  }\n\n  setNewTagsToState() {\n    let stateTagsArray = [];\n    stateTagsArray = this.state.tags;\n    let newTagFieldValue = document.getElementById(\"newTagField\").value;\n    let selectTagFieldValue = document.getElementById(\"tag-select-field\").childNodes;\n\n    for (var i = 0; i < selectTagFieldValue.length; i++) {\n      if (selectTagFieldValue[i].selected) {\n        var containsInState = false;\n\n        for (var j = 0; j < stateTagsArray.length; j++) {\n          if (stateTagsArray[j].name === selectTagFieldValue[i].textContent) {\n            containsInState = true;\n            break;\n          }\n        }\n\n        if (!containsInState) {\n          stateTagsArray.push({\n            id: null,\n            name: selectTagFieldValue[i].textContent\n          });\n        }\n\n        containsInState = false;\n      }\n    }\n\n    var thisTagContainsInState = false;\n\n    for (var k = 0; k < stateTagsArray.length; k++) {\n      if (stateTagsArray[k].name === newTagFieldValue) {\n        thisTagContainsInState = true;\n        break;\n      }\n    }\n\n    if (newTagFieldValue.length !== 0 && !thisTagContainsInState) {\n      stateTagsArray.push({\n        id: null,\n        name: newTagFieldValue\n      });\n    }\n\n    for (var i = 0; i < selectTagFieldValue.length; i++) {\n      if (selectTagFieldValue[i].selected) {\n        selectTagFieldValue[i].selected = false;\n      }\n    }\n\n    this.setState({\n      tags: stateTagsArray\n    });\n  }\n\n  buildNewsObjectFromFormFieldsAndState() {\n    let formTitle = document.getElementById(\"newsTitleField\").value;\n    let formShortText = document.getElementById(\"newsShortTextField\").value;\n    let formFullText = document.getElementById(\"newsFullTextField\").value;\n    var newsObject = {\n      id: this.state.newsId,\n      title: formTitle,\n      shortText: formShortText,\n      fullText: formFullText,\n      creationDate: this.state.creationDate,\n      author: this.state.author,\n      tags: this.state.tags\n    };\n    return newsObject;\n  }\n\n  render() {\n    const renderAllTagsList = this.state.allTags.map(t => {\n      return React.createElement(\"option\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, t.name);\n    });\n    const renderThisNewsTags = this.state.tags.map(tag => {\n      return React.createElement(TagButton, {\n        tagName: tag.name,\n        deleteClick: () => this.deleteTagFromState(tag.name),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      });\n    });\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"col-10\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"newsTitleField\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, \"Title\"), React.createElement(\"input\", {\n      id: \"newsTitleField\",\n      className: \"form-control\",\n      type: \"text\",\n      maxLength: \"30\",\n      defaultValue: this.state.newsTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"newsShortTextField\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, \"Short text\"), React.createElement(\"textarea\", {\n      id: \"newsShortTextField\",\n      className: \"form-control\",\n      maxLength: \"100\",\n      rows: \"2\",\n      defaultValue: this.state.newsShortText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"newsFullTextField\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Full text\"), React.createElement(\"textarea\", {\n      className: \"form-control\",\n      id: \"newsFullTextField\",\n      maxLength: \"2000\",\n      rows: \"8\",\n      defaultValue: this.state.newsFullText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"Selected tags\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, renderThisNewsTags)), React.createElement(\"div\", {\n      className: \"col-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"tagsMultiselectField\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, \"Select tags\"), React.createElement(\"select\", {\n      multiple: true,\n      id: \"tag-select-field\",\n      className: \"form-control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, renderAllTagsList), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"input-group mb-3 w-100 my-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      id: \"newTagField\",\n      type: \"text\",\n      className: \"form-control\",\n      placeholder: \"New tag name\",\n      \"aria-describedby\": \"button-addon2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"input-group-append\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-outline-success btn-sm\",\n      type: \"button\",\n      id: \"add-tags-button\",\n      onClick: () => this.setNewTagsToState(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, \"Add tags\")))))))), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-primary btn-block mx-1\",\n      onClick: () => this.editNews(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, \"Save changes\")), React.createElement(\"div\", {\n      className: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"/\",\n      className: \"btn btn-outline-danger btn-block mx-1\",\n      role: \"button\",\n      \"aria-pressed\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, \"Return to news list\"))))))), React.createElement(\"div\", {\n      className: \"col-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default NewsEditForm;","map":{"version":3,"sources":["C:/git/laboratory/news-front/src/component/NewsEditForm.jsx"],"names":["React","NewsDataService","TagDataService","TagButton","NewsEditForm","Component","constructor","props","getNewsByIdCallback","bind","getAllTagsCallback","editNewsCallback","state","newsId","newsTitle","newsShortText","newsFullText","creationDate","author","tags","allTags","componentDidMount","match","params","id","refreshNews","refreshTagsList","getNewsById","getAllTags","editNews","news","buildNewsObjectFromFormFieldsAndState","console","log","createNews","result","setState","title","shortText","fullText","window","location","href","deleteTagFromState","tagName","stateTagsArray","k","length","name","splice","setNewTagsToState","newTagFieldValue","document","getElementById","value","selectTagFieldValue","childNodes","i","selected","containsInState","j","textContent","push","thisTagContainsInState","formTitle","formShortText","formFullText","newsObject","render","renderAllTagsList","map","t","renderThisNewsTags","tag"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,eAAP,MAA4B,mBAA5B;AACA,OAAOC,cAAP,MAA2B,kBAA3B;AACA,OAAOC,SAAP,MAAsB,aAAtB;;AAEA,MAAMC,YAAN,SAA2BJ,KAAK,CAACK,SAAjC,CAA2C;AAEvCC,EAAAA,WAAW,CAACC,KAAD,EAAO;AACd,UAAMA,KAAN;AACA,SAAKC,mBAAL,GAA2B,KAAKA,mBAAL,CAAyBC,IAAzB,CAA8B,IAA9B,CAA3B;AACA,SAAKC,kBAAL,GAA0B,KAAKA,kBAAL,CAAwBD,IAAxB,CAA6B,IAA7B,CAA1B;AACA,SAAKE,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBF,IAAtB,CAA2B,IAA3B,CAAxB;AACA,SAAKG,KAAL,GAAa;AACTC,MAAAA,MAAM,EAAE,EADC;AAETC,MAAAA,SAAS,EAAE,EAFF;AAGTC,MAAAA,aAAa,EAAE,EAHN;AAITC,MAAAA,YAAY,EAAE,EAJL;AAKTC,MAAAA,YAAY,EAAE,EALL;AAMTC,MAAAA,MAAM,EAAE,EANC;AAOTC,MAAAA,IAAI,EAAE,EAPG;AAQTC,MAAAA,OAAO,EAAE;AARA,KAAb;AAUH;;AAEDC,EAAAA,iBAAiB,GAAG;AAChB,QAAG,KAAKd,KAAL,CAAWe,KAAX,CAAiBC,MAAjB,CAAwBC,EAAxB,GAA6B,CAAhC,EAAkC;AAC9B,WAAKC,WAAL,CAAiB,KAAKlB,KAAL,CAAWe,KAAX,CAAiBC,MAAjB,CAAwBC,EAAzC;AACH;;AACD,SAAKE,eAAL;AACH;;AAEDD,EAAAA,WAAW,CAACD,EAAD,EAAK;AACZvB,IAAAA,eAAe,CAAC0B,WAAhB,CAA4B,KAAKnB,mBAAjC,EAAsDgB,EAAtD;AACH;;AAEDE,EAAAA,eAAe,GAAE;AACbxB,IAAAA,cAAc,CAAC0B,UAAf,CAA0B,KAAKlB,kBAA/B;AACH;;AAEDmB,EAAAA,QAAQ,GAAE;AACN,QAAIC,IAAI,GAAG,KAAKC,qCAAL,EAAX;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAS,KAAKrB,KAAL,CAAWC,MAAhC;;AACA,QAAG,KAAKD,KAAL,CAAWC,MAAX,GAAoB,CAAvB,EAAyB;AACrBZ,MAAAA,eAAe,CAAC4B,QAAhB,CAAyB,KAAKlB,gBAA9B,EAAgDmB,IAAhD;AACH,KAFD,MAEO;AACH7B,MAAAA,eAAe,CAACiC,UAAhB,CAA2B,KAAKvB,gBAAhC,EAAkDmB,IAAlD;AACH;AAEJ;;AAEDpB,EAAAA,kBAAkB,CAACyB,MAAD,EAAQ;AACtB,SAAKC,QAAL,CAAc;AAAChB,MAAAA,OAAO,EAAEe;AAAV,KAAd;AACH;;AAED3B,EAAAA,mBAAmB,CAAC2B,MAAD,EAAS;AACxB,SAAKC,QAAL,CAAc;AAACvB,MAAAA,MAAM,EAAEsB,MAAM,CAACX;AAAhB,KAAd;AACA,SAAKY,QAAL,CAAc;AAACtB,MAAAA,SAAS,EAAEqB,MAAM,CAACE;AAAnB,KAAd;AACA,SAAKD,QAAL,CAAc;AAACrB,MAAAA,aAAa,EAAEoB,MAAM,CAACG;AAAvB,KAAd;AACA,SAAKF,QAAL,CAAc;AAACpB,MAAAA,YAAY,EAAEmB,MAAM,CAACI;AAAtB,KAAd;AACA,SAAKH,QAAL,CAAc;AAACnB,MAAAA,YAAY,EAAEkB,MAAM,CAAClB;AAAtB,KAAd;AACA,SAAKmB,QAAL,CAAc;AAAClB,MAAAA,MAAM,EAAEiB,MAAM,CAACjB;AAAhB,KAAd;AACA,SAAKkB,QAAL,CAAc;AAACjB,MAAAA,IAAI,EAAEgB,MAAM,CAAChB;AAAd,KAAd;AACH;;AAGDR,EAAAA,gBAAgB,CAACwB,MAAD,EAAQ;AACpBK,IAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,gBAAgBP,MAAM,CAACX,EAA9C;AACH;;AAEDmB,EAAAA,kBAAkB,CAACC,OAAD,EAAS;AACvB,QAAIC,cAAc,GAAG,EAArB;AACAA,IAAAA,cAAc,GAAG,KAAKjC,KAAL,CAAWO,IAA5B;;AAEA,SAAI,IAAI2B,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACD,cAAc,CAACE,MAA9B,EAAsCD,CAAC,EAAvC,EAA0C;AACtC,UAAGD,cAAc,CAACC,CAAD,CAAd,CAAkBE,IAAlB,KAA2BJ,OAA9B,EAAsC;AAClCC,QAAAA,cAAc,CAACI,MAAf,CAAsBH,CAAtB,EAAyB,CAAzB;AACA;AACH;AACJ;;AAED,SAAKV,QAAL,CAAc;AAACjB,MAAAA,IAAI,EAAE0B;AAAP,KAAd;AACH;;AAEDK,EAAAA,iBAAiB,GAAE;AACf,QAAIL,cAAc,GAAG,EAArB;AACAA,IAAAA,cAAc,GAAG,KAAKjC,KAAL,CAAWO,IAA5B;AACA,QAAIgC,gBAAgB,GAAGC,QAAQ,CAACC,cAAT,CAAwB,aAAxB,EAAuCC,KAA9D;AACA,QAAIC,mBAAmB,GAAGH,QAAQ,CAACC,cAAT,CAAwB,kBAAxB,EAA4CG,UAAtE;;AAEA,SAAI,IAAIC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACF,mBAAmB,CAACR,MAAnC,EAA2CU,CAAC,EAA5C,EAA+C;AAC3C,UAAGF,mBAAmB,CAACE,CAAD,CAAnB,CAAuBC,QAA1B,EAAmC;AAE/B,YAAIC,eAAe,GAAG,KAAtB;;AAEA,aAAI,IAAIC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACf,cAAc,CAACE,MAA9B,EAAsCa,CAAC,EAAvC,EAA0C;AACtC,cAAGf,cAAc,CAACe,CAAD,CAAd,CAAkBZ,IAAlB,KAA2BO,mBAAmB,CAACE,CAAD,CAAnB,CAAuBI,WAArD,EAAiE;AAC7DF,YAAAA,eAAe,GAAG,IAAlB;AACA;AACH;AACJ;;AACD,YAAG,CAACA,eAAJ,EAAoB;AAChBd,UAAAA,cAAc,CAACiB,IAAf,CAAoB;AAACtC,YAAAA,EAAE,EAAE,IAAL;AAAWwB,YAAAA,IAAI,EAAEO,mBAAmB,CAACE,CAAD,CAAnB,CAAuBI;AAAxC,WAApB;AACH;;AAEDF,QAAAA,eAAe,GAAG,KAAlB;AACH;AACJ;;AAED,QAAII,sBAAsB,GAAG,KAA7B;;AAEA,SAAI,IAAIjB,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACD,cAAc,CAACE,MAA9B,EAAsCD,CAAC,EAAvC,EAA0C;AACtC,UAAGD,cAAc,CAACC,CAAD,CAAd,CAAkBE,IAAlB,KAA2BG,gBAA9B,EAA+C;AAC3CY,QAAAA,sBAAsB,GAAG,IAAzB;AACA;AACH;AACJ;;AAED,QAAIZ,gBAAgB,CAACJ,MAAjB,KAA4B,CAA7B,IAAoC,CAACgB,sBAAxC,EAAgE;AAC5DlB,MAAAA,cAAc,CAACiB,IAAf,CAAoB;AAACtC,QAAAA,EAAE,EAAE,IAAL;AAAWwB,QAAAA,IAAI,EAAEG;AAAjB,OAApB;AACH;;AAED,SAAI,IAAIM,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACF,mBAAmB,CAACR,MAAnC,EAA2CU,CAAC,EAA5C,EAA+C;AAC3C,UAAGF,mBAAmB,CAACE,CAAD,CAAnB,CAAuBC,QAA1B,EAAmC;AAC/BH,QAAAA,mBAAmB,CAACE,CAAD,CAAnB,CAAuBC,QAAvB,GAAkC,KAAlC;AACH;AACJ;;AAED,SAAKtB,QAAL,CAAc;AAACjB,MAAAA,IAAI,EAAE0B;AAAP,KAAd;AAEH;;AAEDd,EAAAA,qCAAqC,GAAE;AACnC,QAAIiC,SAAS,GAAGZ,QAAQ,CAACC,cAAT,CAAwB,gBAAxB,EAA0CC,KAA1D;AACA,QAAIW,aAAa,GAAGb,QAAQ,CAACC,cAAT,CAAwB,oBAAxB,EAA8CC,KAAlE;AACA,QAAIY,YAAY,GAAGd,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,EAA6CC,KAAhE;AAEA,QAAIa,UAAU,GAAG;AAAC3C,MAAAA,EAAE,EAAE,KAAKZ,KAAL,CAAWC,MAAhB;AACCwB,MAAAA,KAAK,EAAE2B,SADR;AAEC1B,MAAAA,SAAS,EAAE2B,aAFZ;AAGC1B,MAAAA,QAAQ,EAAE2B,YAHX;AAICjD,MAAAA,YAAY,EAAE,KAAKL,KAAL,CAAWK,YAJ1B;AAKCC,MAAAA,MAAM,EAAE,KAAKN,KAAL,CAAWM,MALpB;AAMCC,MAAAA,IAAI,EAAE,KAAKP,KAAL,CAAWO;AANlB,KAAjB;AAQA,WAAOgD,UAAP;AAEH;;AAEDC,EAAAA,MAAM,GAAE;AAEJ,UAAMC,iBAAiB,GAAG,KAAKzD,KAAL,CAAWQ,OAAX,CAAmBkD,GAAnB,CAAuBC,CAAC,IAAI;AAClD,aACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAASA,CAAC,CAACvB,IAAX,CADA;AAGH,KAJyB,CAA1B;AAMA,UAAMwB,kBAAkB,GAAG,KAAK5D,KAAL,CAAWO,IAAX,CAAgBmD,GAAhB,CAAoBG,GAAG,IAAI;AAClD,aACI,oBAAC,SAAD;AACA,QAAA,OAAO,EAAEA,GAAG,CAACzB,IADb;AAEA,QAAA,WAAW,EAAE,MAAM,KAAKL,kBAAL,CAAwB8B,GAAG,CAACzB,IAA5B,CAFnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ;AAMH,KAP0B,CAA3B;AASA,WAEI;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEI;AAAK,MAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,GAAG,EAAC,gBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADJ,EAEI;AAAO,MAAA,EAAE,EAAC,gBAAV;AAA2B,MAAA,SAAS,EAAC,cAArC;AAAoD,MAAA,IAAI,EAAC,MAAzD;AAAgE,MAAA,SAAS,EAAC,IAA1E;AAA+E,MAAA,YAAY,EAAE,KAAKpC,KAAL,CAAWE,SAAxG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CADJ,EAKI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,GAAG,EAAC,oBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,EAEI;AAAU,MAAA,EAAE,EAAC,oBAAb;AAAkC,MAAA,SAAS,EAAC,cAA5C;AAA2D,MAAA,SAAS,EAAC,KAArE;AAA2E,MAAA,IAAI,EAAC,GAAhF;AAAoF,MAAA,YAAY,EAAE,KAAKF,KAAL,CAAWG,aAA7G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CALJ,EASI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,GAAG,EAAC,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADJ,EAEI;AAAU,MAAA,SAAS,EAAC,cAApB;AAAmC,MAAA,EAAE,EAAC,mBAAtC;AAA2D,MAAA,SAAS,EAAC,MAArE;AAA4E,MAAA,IAAI,EAAC,GAAjF;AAAqF,MAAA,YAAY,EAAE,KAAKH,KAAL,CAAWI,YAA9G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CATJ,EAaI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACKwD,kBADL,CAFJ,CADJ,EAOI;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,GAAG,EAAC,sBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADJ,EAEI;AAAQ,MAAA,QAAQ,MAAhB;AAAkB,MAAA,EAAE,EAAC,kBAArB;AAAwC,MAAA,SAAS,EAAC,cAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACKH,iBADL,CAFJ,EAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,6BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,EAAE,EAAC,aAAV;AAAwB,MAAA,IAAI,EAAC,MAA7B;AAAoC,MAAA,SAAS,EAAC,cAA9C;AAA6D,MAAA,WAAW,EAAC,cAAzE;AAAwF,0BAAiB,eAAzG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEI;AAAK,MAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAQ,MAAA,SAAS,EAAC,gCAAlB;AAAmD,MAAA,IAAI,EAAC,QAAxD;AAAiE,MAAA,EAAE,EAAC,iBAApE;AAAsF,MAAA,OAAO,EAAE,MAAM,KAAKnB,iBAAL,EAArG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,CAFJ,CADJ,CALJ,CAPJ,CADJ,CADJ,CAbJ,EAuCI;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,SAAS,EAAC,gCAAhC;AAAiE,MAAA,OAAO,EAAE,MAAM,KAAKrB,QAAL,EAAhF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADJ,CADJ,EAII;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAG,MAAA,IAAI,EAAC,GAAR;AAAY,MAAA,SAAS,EAAC,uCAAtB;AAA8D,MAAA,IAAI,EAAC,QAAnE;AAA4E,sBAAa,MAAzF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BADJ,CAJJ,CADJ,CAvCJ,CADJ,CADJ,CAFJ,EAwDI;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAxDJ,CADA,CAFJ;AAiEH;;AAjOsC;;AAoO3C,eAAezB,YAAf","sourcesContent":["import React from 'react'\r\nimport NewsDataService from './NewsDataService'\r\nimport TagDataService from './TagDataService'\r\nimport TagButton from './TagButton'\r\n\r\nclass NewsEditForm extends React.Component {\r\n\r\n    constructor(props){\r\n        super(props);\r\n        this.getNewsByIdCallback = this.getNewsByIdCallback.bind(this);\r\n        this.getAllTagsCallback = this.getAllTagsCallback.bind(this);\r\n        this.editNewsCallback = this.editNewsCallback.bind(this);\r\n        this.state = {\r\n            newsId: {},\r\n            newsTitle: '',\r\n            newsShortText: '',\r\n            newsFullText: '',\r\n            creationDate: '',\r\n            author: {},\r\n            tags: [],\r\n            allTags: [],\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        if(this.props.match.params.id > 0){\r\n            this.refreshNews(this.props.match.params.id);\r\n        }\r\n        this.refreshTagsList();\r\n    }\r\n\r\n    refreshNews(id) {\r\n        NewsDataService.getNewsById(this.getNewsByIdCallback, id);\r\n    }\r\n\r\n    refreshTagsList(){\r\n        TagDataService.getAllTags(this.getAllTagsCallback);\r\n    }\r\n\r\n    editNews(){\r\n        let news = this.buildNewsObjectFromFormFieldsAndState();\r\n        console.log(\"ID: \" + this.state.newsId);\r\n        if(this.state.newsId > 0){\r\n            NewsDataService.editNews(this.editNewsCallback, news);\r\n        } else {\r\n            NewsDataService.createNews(this.editNewsCallback, news);\r\n        }\r\n        \r\n    }\r\n\r\n    getAllTagsCallback(result){\r\n        this.setState({allTags: result});\r\n    }\r\n\r\n    getNewsByIdCallback(result) {\r\n        this.setState({newsId: result.id});\r\n        this.setState({newsTitle: result.title});\r\n        this.setState({newsShortText: result.shortText});\r\n        this.setState({newsFullText: result.fullText});\r\n        this.setState({creationDate: result.creationDate});\r\n        this.setState({author: result.author});\r\n        this.setState({tags: result.tags});\r\n    }  \r\n\r\n\r\n    editNewsCallback(result){\r\n        window.location.href = \"/news/edit/\" + result.id;\r\n    }\r\n\r\n    deleteTagFromState(tagName){\r\n        let stateTagsArray = [];\r\n        stateTagsArray = this.state.tags;\r\n\r\n        for(var k=0; k<stateTagsArray.length; k++){\r\n            if(stateTagsArray[k].name === tagName){\r\n                stateTagsArray.splice(k, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        this.setState({tags: stateTagsArray});\r\n    }\r\n\r\n    setNewTagsToState(){\r\n        let stateTagsArray = [];\r\n        stateTagsArray = this.state.tags;\r\n        let newTagFieldValue = document.getElementById(\"newTagField\").value;\r\n        let selectTagFieldValue = document.getElementById(\"tag-select-field\").childNodes; \r\n\r\n        for(var i=0; i<selectTagFieldValue.length; i++){\r\n            if(selectTagFieldValue[i].selected){\r\n\r\n                var containsInState = false;\r\n\r\n                for(var j=0; j<stateTagsArray.length; j++){\r\n                    if(stateTagsArray[j].name === selectTagFieldValue[i].textContent){\r\n                        containsInState = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if(!containsInState){\r\n                    stateTagsArray.push({id: null, name: selectTagFieldValue[i].textContent});\r\n                }\r\n\r\n                containsInState = false;\r\n            }\r\n        }\r\n\r\n        var thisTagContainsInState = false;\r\n\r\n        for(var k=0; k<stateTagsArray.length; k++){\r\n            if(stateTagsArray[k].name === newTagFieldValue){\r\n                thisTagContainsInState = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if((newTagFieldValue.length !== 0) && (!thisTagContainsInState)){\r\n            stateTagsArray.push({id: null, name: newTagFieldValue});\r\n        }\r\n\r\n        for(var i=0; i<selectTagFieldValue.length; i++){\r\n            if(selectTagFieldValue[i].selected){\r\n                selectTagFieldValue[i].selected = false;\r\n            }\r\n        }\r\n\r\n        this.setState({tags: stateTagsArray});\r\n        \r\n    }\r\n\r\n    buildNewsObjectFromFormFieldsAndState(){\r\n        let formTitle = document.getElementById(\"newsTitleField\").value;\r\n        let formShortText = document.getElementById(\"newsShortTextField\").value;\r\n        let formFullText = document.getElementById(\"newsFullTextField\").value;\r\n\r\n        var newsObject = {id: this.state.newsId,\r\n                          title: formTitle,\r\n                          shortText: formShortText,\r\n                          fullText: formFullText,\r\n                          creationDate: this.state.creationDate,\r\n                          author: this.state.author,\r\n                          tags: this.state.tags};\r\n\r\n        return newsObject;\r\n\r\n    }\r\n\r\n    render(){\r\n\r\n        const renderAllTagsList = this.state.allTags.map(t => {\r\n            return(\r\n            <option>{t.name}</option>\r\n            )\r\n        })\r\n\r\n        const renderThisNewsTags = this.state.tags.map(tag => {\r\n            return(\r\n                <TagButton \r\n                tagName={tag.name}\r\n                deleteClick={() => this.deleteTagFromState(tag.name)}\r\n                />\r\n            )\r\n        }) \r\n\r\n        return(\r\n\r\n            <div className=\"container\">\r\n            <div className=\"row\">\r\n                <div className=\"col-1\"></div>\r\n                <div className=\"col-10\">\r\n                    <div>\r\n                        <form>\r\n                            <div className=\"form-group\">\r\n                                <label for=\"newsTitleField\">Title</label>\r\n                                <input id=\"newsTitleField\" className=\"form-control\" type=\"text\" maxLength=\"30\" defaultValue={this.state.newsTitle}/>\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label for=\"newsShortTextField\">Short text</label>\r\n                                <textarea id=\"newsShortTextField\" className=\"form-control\" maxLength=\"100\" rows=\"2\" defaultValue={this.state.newsShortText}></textarea>\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label for=\"newsFullTextField\">Full text</label>\r\n                                <textarea className=\"form-control\" id=\"newsFullTextField\"  maxLength=\"2000\" rows=\"8\" defaultValue={this.state.newsFullText}></textarea>\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <div className=\"container\">\r\n                                    <div className=\"row\">\r\n                                        <div className=\"col-6\">\r\n                                            <label>Selected tags</label>\r\n                                            <div>\r\n                                                {renderThisNewsTags}\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"col-6\">\r\n                                            <label for=\"tagsMultiselectField\">Select tags</label>\r\n                                            <select multiple  id=\"tag-select-field\" className=\"form-control\">\r\n                                                {renderAllTagsList}\r\n                                            </select>\r\n                                            <div>\r\n                                                <div className=\"input-group mb-3 w-100 my-3\">\r\n                                                    <input id=\"newTagField\" type=\"text\" className=\"form-control\" placeholder=\"New tag name\" aria-describedby=\"button-addon2\"/>\r\n                                                    <div className=\"input-group-append\">\r\n                                                        <button className=\"btn btn-outline-success btn-sm\" type=\"button\" id=\"add-tags-button\" onClick={() => this.setNewTagsToState()}>Add tags</button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"container\">\r\n                                <div className=\"row\">\r\n                                    <div className=\"col\">\r\n                                        <button type=\"button\" className=\"btn btn-primary btn-block mx-1\" onClick={() => this.editNews()}>Save changes</button>\r\n                                    </div>\r\n                                    <div className=\"col\">\r\n                                        <a href=\"/\" className=\"btn btn-outline-danger btn-block mx-1\" role=\"button\" aria-pressed=\"true\">Return to news list</a>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n                <div className=\"col-1\"></div>\r\n            </div>\r\n        </div>\r\n\r\n           \r\n        );\r\n    }\r\n}\r\n\r\nexport default NewsEditForm"]},"metadata":{},"sourceType":"module"}